import{a as c}from"./axios-BimPEqV4.js";import{o as n,c as r,a as s,a0 as u,ad as p,ac as m,X as _,Y as d}from"./@vue-CR-AUDWE.js";import{_ as h}from"./plugin-vueexport-helper-DlAUqK2U.js";const f={name:"TextToSpeech",data(){return{input:"",audioUrl:"",loading:!1}},methods:{async talk(){if(!this.input.trim()){alert("请输入有效文本");return}this.loading=!0;try{const a=await c.post("/api/infer/gen",{access_token:"67b6cb3ac10960247bbe7401936bd3f5",type:"tts",brand:"gpt-sovits",name:"anime",method:"api",prarm:{speaker:"七七【原神】",emotion:"中立",text:this.input,text_language:"中文"}},{headers:{"Content-Type":"application/json"},timeout:0});this.loading=!1,a.data&&a.data.audio?(this.audioUrl=a.data.audio,this.$nextTick(()=>{const t=this.$refs.audioPlayer;t&&(t.load(),t.play().catch(l=>{console.error("自动播放失败：",l),alert("无法自动播放，请手动播放")}))})):alert("语音生成失败，请重试")}catch(a){this.loading=!1,alert("请求失败，请检查网络连接"),console.error(a)}}}},g={class:"container"},y={class:"input-container"},k=["disabled"],x={key:0,class:"loading-container"},b=s("p",{class:"loading-text"},"语音生成中，请稍候...",-1),v=[b],T={key:1,class:"audio-container"},U=["src"];function w(a,t,l,B,e,i){return n(),r("div",g,[s("div",y,[u(s("input",{class:"input-field",type:"text","onUpdate:modelValue":t[0]||(t[0]=o=>e.input=o),onKeyup:t[1]||(t[1]=m((...o)=>i.talk&&i.talk(...o),["enter"])),placeholder:"请输入文本，按回车生成语音"},null,544),[[p,e.input]]),s("button",{class:"submit-button",onClick:t[2]||(t[2]=(...o)=>i.talk&&i.talk(...o)),disabled:e.loading},_(e.loading?"生成中...":"生成语音"),9,k)]),e.loading?(n(),r("div",x,v)):d("",!0),e.audioUrl?(n(),r("div",T,[s("audio",{ref:"audioPlayer",src:e.audioUrl,controls:"",autoplay:""},null,8,U)])):d("",!0)])}const K=h(f,[["render",w]]);export{K as default};
