import{a as m}from"./axios-xsH4HHeE.js";import{c as i,o as n,a as r,I as c,A as l,ay as u,az as _,F as k,a7 as f,aa as v,U as a}from"./@vue-CYelYcYe.js";import{_ as x}from"./plugin-vueexport-helper-DlAUqK2U.js";const y="https://gsv.ai-lab.top",g={async inferVoice(s){const h={...{batch_size:10,batch_threshold:.75,fragment_interval:.3,media_type:"wav",parallel_infer:!0,repetition_penalty:1.35,seed:-1,split_bucket:!0,temperature:1,text_split_method:"按标点符号切",top_k:10,top_p:1},...s};try{return(await m.post(`${y}/infer_single`,h)).data}catch(p){throw console.error("Error in voice inference:",p),p}},async getSpeakers(s){try{return(await m.post(`${y}/spks`,{model:s})).data}catch(e){throw console.error("Error fetching speakers:",e),e}}},S={name:"VoiceClone",data(){return{selectedModel:"【原神】蒙德",selectedSpeaker:"",selectedEmotion:"",text:"",speed:1,audioUrl:"",isLoading:!1,error:"",speakers:[],emotions:[],speakerDetails:{}}},async created(){await this.fetchSpeakers()},watch:{selectedSpeaker(s){s&&this.speakerDetails[s]?(this.emotions=this.speakerDetails[s].中文||[],this.emotions.length>0&&(this.selectedEmotion=this.emotions[0])):(this.emotions=[],this.selectedEmotion="")}},methods:{async fetchSpeakers(){this.isLoading=!0,this.error="";try{const s=await g.getSpeakers(this.selectedModel);s.spklist?(this.speakers=Object.keys(s.spklist),this.speakerDetails=Object.fromEntries(this.speakers.map(e=>[e,{中文:s.spklist[e]}]))):s.speakers&&(this.speakers=Object.keys(s.speakers),this.speakerDetails=s.speakers),this.speakers.length>0&&(this.selectedSpeaker=this.speakers[0])}catch(s){console.error("Error fetching speakers:",s),this.error="Failed to fetch speakers. Please try again."}finally{this.isLoading=!1}},async synthesize(){if(!this.text.trim()){this.error="Please enter some text to synthesize";return}if(!this.selectedSpeaker){this.error="Please select a speaker";return}this.isLoading=!0,this.error="",this.audioUrl="";try{const s={access_token:"e25841bfe860bf89e356b3e5b999c470",text:this.text,speaker_name:this.selectedSpeaker,emotion:this.selectedEmotion||"中立_neutral",model_name:this.selectedModel,speed_facter:this.speed,text_lang:"中文",prompt_text_lang:"中文"},e=await g.inferVoice(s);this.audioUrl=e.audio_url||e.audioUrl}catch(s){console.error("Error in voice synthesis:",s),this.error="Failed to synthesize voice. Please try again."}finally{this.isLoading=!1}}}},b={class:"voice-clone-container"},E={class:"control-group"},U={key:0,class:"control-group"},w=["value"],z={key:1,class:"control-group"},V=["value"],D={class:"control-group"},L={class:"control-group"},M={class:"control-group"},P=["disabled"],C={key:2,class:"audio-player"},B=["src"],F=["href"],j={key:3,class:"error-message"};function A(s,e,h,p,t,d){return n(),i("div",b,[e[13]||(e[13]=r("h1",null,"Voice Cloning",-1)),r("div",E,[e[8]||(e[8]=r("label",{for:"model-select"},"Model:",-1)),l(r("select",{id:"model-select","onUpdate:modelValue":e[0]||(e[0]=o=>t.selectedModel=o),onChange:e[1]||(e[1]=(...o)=>d.fetchSpeakers&&d.fetchSpeakers(...o))},e[7]||(e[7]=[_('<option value="【原神】蒙德" data-v-c77e88ae>【原神】蒙德</option><option value="【原神】稻妻" data-v-c77e88ae>【原神】稻妻</option><option value="【原神】璃月" data-v-c77e88ae>【原神】璃月</option><option value="【原神】枫丹" data-v-c77e88ae>【原神】枫丹</option><option value="【原神】纳塔" data-v-c77e88ae>【原神】纳塔</option><option value="【原神】须弥" data-v-c77e88ae>【原神】须弥</option><option value="【原神】降临者" data-v-c77e88ae>【原神】降临者</option>',7)]),544),[[u,t.selectedModel]])]),t.speakers.length>0?(n(),i("div",U,[e[9]||(e[9]=r("label",{for:"speaker-select"},"Speaker:",-1)),l(r("select",{id:"speaker-select","onUpdate:modelValue":e[2]||(e[2]=o=>t.selectedSpeaker=o)},[(n(!0),i(k,null,f(t.speakers,o=>(n(),i("option",{key:o,value:o},a(o),9,w))),128))],512),[[u,t.selectedSpeaker]])])):c("",!0),t.emotions.length>0?(n(),i("div",z,[e[10]||(e[10]=r("label",{for:"emotion-select"},"Emotion:",-1)),l(r("select",{id:"emotion-select","onUpdate:modelValue":e[3]||(e[3]=o=>t.selectedEmotion=o)},[(n(!0),i(k,null,f(t.emotions,o=>(n(),i("option",{key:o,value:o},a(o),9,V))),128))],512),[[u,t.selectedEmotion]])])):c("",!0),r("div",D,[e[11]||(e[11]=r("label",{for:"text-input"},"Text:",-1)),l(r("textarea",{id:"text-input","onUpdate:modelValue":e[4]||(e[4]=o=>t.text=o),placeholder:"Enter text to synthesize"},null,512),[[v,t.text]])]),r("div",L,[e[12]||(e[12]=r("label",{for:"speed-input"},"Speed:",-1)),l(r("input",{id:"speed-input",type:"range","onUpdate:modelValue":e[5]||(e[5]=o=>t.speed=o),min:"0.5",max:"2",step:"0.1"},null,512),[[v,t.speed]]),r("span",null,a(t.speed)+"x",1)]),r("div",M,[r("button",{onClick:e[6]||(e[6]=(...o)=>d.synthesize&&d.synthesize(...o)),disabled:t.isLoading},a(t.isLoading?"Synthesizing...":"Synthesize Voice"),9,P)]),t.audioUrl?(n(),i("div",C,[r("audio",{controls:"",src:t.audioUrl},null,8,B),r("a",{href:t.audioUrl,download:"synthesized_voice.wav",class:"download-btn"}," Download ",8,F)])):c("",!0),t.error?(n(),i("div",j,a(t.error),1)):c("",!0)])}const T=x(S,[["render",A],["__scopeId","data-v-c77e88ae"]]);export{T as default};
